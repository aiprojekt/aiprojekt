<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>OpenNN examples</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <div style="background-color: white">
        <center>
        <img src="images/logo.png" />
        </center>
      </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="about">About</h1>

<p>This page includes some examples for the Open NN library: <a href="http://opennn.cimne.com/">http://opennn.cimne.com/</a></p>

          <h1 id="modeling-of-data">Modeling of data</h1>

<h2 id="linear-regression-analysis-for-predicting-self-noise-of-airfoils">Linear regression analysis for predicting self noise of airfoils</h2>
<pre class="highlight cpp"><code>    <span class="cp">#include &lt;iostream&gt;
</span>    <span class="cp">#include &lt;fstream&gt;
</span>    <span class="cp">#include &lt;sstream&gt;
</span>    <span class="cp">#include &lt;string&gt;
</span>    <span class="cp">#include &lt;cstring&gt;
</span>    <span class="cp">#include &lt;time.h&gt;
</span>
    <span class="cp">#include "../../source/opennn.h"
</span>
    <span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

    <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

        <span class="n">DataSet</span> <span class="n">data_set</span><span class="p">;</span>
        <span class="n">data_set</span><span class="p">.</span><span class="n">load_data</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/airfoil_self_noise.dat"</span><span class="p">);</span>

        <span class="n">VariablesInformation</span><span class="o">*</span> <span class="n">variables_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information_pointer</span><span class="p">();</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"frequency"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"hertzs"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"angle_of_attack"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"degrees"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"chord_length"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"meters"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">"free_stream_velocity"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">"meters per second"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">"suction_side_displacement_thickness"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">"meters"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s">"scaled_sound_pressure_level"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s">"decibels"</span><span class="p">);</span>

        <span class="k">const</span> <span class="n">Vector</span><span class="o">&lt;</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">inputs_targets_information</span> <span class="o">=</span> <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">arrange_inputs_targets_information</span><span class="p">();</span>

        <span class="k">const</span> <span class="n">Vector</span><span class="o">&lt;</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">inputs_targets_statistics</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">scale_inputs_targets</span><span class="p">();</span>

        <span class="n">InstancesInformation</span><span class="o">*</span> <span class="n">instances_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_instances_information_pointer</span><span class="p">();</span>

        <span class="n">instances_information_pointer</span><span class="o">-&gt;</span><span class="n">split_random_indices</span><span class="p">();</span>

        <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">inputs_number</span> <span class="o">=</span> <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">count_inputs_number</span><span class="p">();</span>
        <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hidden_perceptrons_number</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
        <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">outputs_number</span> <span class="o">=</span> <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">count_targets_number</span><span class="p">();</span>
        <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="n">inputs_number</span><span class="p">,</span> <span class="n">hidden_perceptrons_number</span><span class="p">,</span> <span class="n">outputs_number</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_outputs_information</span><span class="p">(</span><span class="n">inputs_targets_information</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_outputs_statistics</span><span class="p">(</span><span class="n">inputs_targets_statistics</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_unscaling_layers_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

        <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>

        <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
        <span class="n">QuasiNewtonMethod</span><span class="o">*</span> <span class="n">quasi_Newton_method_pointer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QuasiNewtonMethod</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
        <span class="n">quasi_Newton_method_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum_performance_increase</span><span class="p">(</span><span class="mf">1.0e-6</span><span class="p">);</span>
        <span class="n">quasi_Newton_method_pointer</span><span class="o">-&gt;</span><span class="n">set_reserve_evaluation_history</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="n">training_strategy</span><span class="p">.</span><span class="n">set_main_training_algorithm_pointer</span><span class="p">(</span><span class="n">quasi_Newton_method_pointer</span><span class="p">);</span>
        <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_scaling_outputs_unscaling_methods</span><span class="p">(</span><span class="s">"MinimumMaximum"</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_unscaling_layers_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

        <span class="n">TestingAnalysis</span> <span class="n">testing_analysis</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>
        <span class="n">FunctionRegressionTesting</span><span class="o">*</span> <span class="n">function_regression_testing_pointer</span> <span class="o">=</span> <span class="n">testing_analysis</span><span class="p">.</span><span class="n">get_function_regression_testing_pointer</span><span class="p">();</span>
        <span class="n">FunctionRegressionTesting</span><span class="o">::</span><span class="n">LinearRegressionAnalysisResults</span> <span class="n">linear_regression_analysis_results</span> <span class="o">=</span> <span class="n">function_regression_testing_pointer</span><span class="o">-&gt;</span><span class="n">perform_linear_regression_analysis</span><span class="p">();</span>

        <span class="n">data_set</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/data_set.xml"</span><span class="p">);</span>
        <span class="n">data_set</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/data_set.xml"</span><span class="p">);</span>

        <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/neural_network.xml"</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/neural_network.xml"</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/expression.txt"</span><span class="p">);</span>

        <span class="n">performance_functional</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/performance_functional.xml"</span><span class="p">);</span>
        <span class="n">performance_functional</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/performance_functional.xml"</span><span class="p">);</span>

        <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/training_strategy.xml"</span><span class="p">);</span>
        <span class="n">training_strategy</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/training_strategy.xml"</span><span class="p">);</span>

        <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/training_strategy_results.dat"</span><span class="p">);</span>

        <span class="n">linear_regression_analysis_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/linear_regression_analysis_results.dat"</span><span class="p">);</span>

        <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="images/AirfoilSelfNoise.gif" /></p>

<p><a href="data/airfoil_self_noise_data.dat">Download data set</a>
<br>
<br>
<br>
<br>
Loading the data set
<br>
<br>
<br>
Variables information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Instances information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Neural network
<br>
<br>
<br>
Performance functional
<br>
Training strategy object
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Testing analysis
<br>
<br>
<br>
<br>
<br>
<br>
Save results</p>

<h2 id="linear-regression-analysis-for-predicting-residuary-resistance-of-yachts">Linear regression analysis for predicting residuary resistance of yachts</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;sstream&gt;
#include &lt;string&gt;
#include &lt;cstring&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#include "../../source/opennn.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

    <span class="n">DataSet</span> <span class="n">data_set</span><span class="p">;</span>
    <span class="n">data_set</span><span class="p">.</span><span class="n">load_data</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/delft.dat"</span><span class="p">);</span>

    <span class="n">VariablesInformation</span><span class="o">*</span> <span class="n">variables_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information_pointer</span><span class="p">();</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"longitudinal_center_buoyancy"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"prismatic_coecient"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"length_displacement_ratio"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">"beam_draught_ratio"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">"length_beam_ratio"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s">"froude_number"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s">"residuary_resistance"</span><span class="p">);</span>
    <span class="k">const</span> <span class="n">Vector</span><span class="o">&lt;</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">inputs_targets_information</span> <span class="o">=</span> <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">arrange_inputs_targets_information</span><span class="p">();</span>

    <span class="n">InstancesInformation</span><span class="o">*</span> <span class="n">instances_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_instances_information_pointer</span><span class="p">();</span>
    <span class="n">instances_information_pointer</span><span class="o">-&gt;</span><span class="n">split_random_indices</span><span class="p">();</span>
    <span class="k">const</span> <span class="n">Vector</span><span class="o">&lt;</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">inputs_targets_statistics</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">scale_inputs_targets</span><span class="p">();</span>

    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">inputs_number</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information</span><span class="p">().</span><span class="n">count_inputs_number</span><span class="p">();</span>
    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hidden_neurons_number</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">outputs_number</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information</span><span class="p">().</span><span class="n">count_targets_number</span><span class="p">();</span>
    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="n">inputs_number</span><span class="p">,</span> <span class="n">hidden_neurons_number</span><span class="p">,</span> <span class="n">outputs_number</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_outputs_information</span><span class="p">(</span><span class="n">inputs_targets_information</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_outputs_statistics</span><span class="p">(</span><span class="n">inputs_targets_statistics</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_unscaling_layers_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_unscaling_layers_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

    <span class="n">TestingAnalysis</span> <span class="n">testing_analysis</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>
    <span class="n">FunctionRegressionTesting</span><span class="o">*</span> <span class="n">function_regression_testing_pointer</span> <span class="o">=</span> <span class="n">testing_analysis</span><span class="p">.</span><span class="n">get_function_regression_testing_pointer</span><span class="p">();</span>
    <span class="n">FunctionRegressionTesting</span><span class="o">::</span><span class="n">LinearRegressionAnalysisResults</span> <span class="n">linear_regression_analysis_results</span> <span class="o">=</span> <span class="n">function_regression_testing_pointer</span><span class="o">-&gt;</span><span class="n">perform_linear_regression_analysis</span><span class="p">();</span>

    <span class="n">data_set</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/neural_network.xml"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/neural_network.xml"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/expression.txt"</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/training_strategy.xml"</span><span class="p">);</span>
    <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/training_strategy_results.dat"</span><span class="p">);</span>

    <span class="n">linear_regression_analysis_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/linear_regression_analysis_results.dat"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</code></pre>

<p><img alt="Alt text" src="images/YachtResistanceProblem.gif" /></p>

<p><a href="data/yacht_resistance.dat">Download data set</a>
<br>
<br>
Loading the data set
<br>
<br>
<br>
Variables information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Instances information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Neural network
<br>
<br>
<br>
Performance functional
<br>
<br>
Training strategy object
<br>
<br>
<br>
Testing analysis
<br>
<br>
<br>
<br>
Save results</p>

          <h1 id="classical-problems-in-the-calculus-of-variations">Classical problems in the calculus of variations</h1>

<h2 id="geodesic-problem">Geodesic problem</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
#include "arc_length.h"
#include "../../source/opennn.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xa</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">ya</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xb</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">yb</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>

    <span class="n">ArcLength</span> <span class="n">arc_length</span><span class="p">;</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">set_initial_independent_variable</span><span class="p">(</span><span class="n">xa</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>

    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"x"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"y"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_scaling_layer</span><span class="p">();</span>

    <span class="n">ScalingLayer</span><span class="o">*</span> <span class="n">scaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_scaling_layer_pointer</span><span class="p">();</span>
    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xa</span><span class="p">);</span>
    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xb</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_unscaling_layer</span><span class="p">();</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_unscaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_conditions_layer</span><span class="p">();</span>
    <span class="n">ConditionsLayer</span><span class="o">*</span> <span class="n">conditions_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_conditions_layer_pointer</span><span class="p">();</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xa</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xb</span><span class="p">);</span>

    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ya</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">yb</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_conditions_layer_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">construct_objective_term</span><span class="p">(</span><span class="n">PerformanceFunctional</span><span class="o">::</span><span class="n">FINAL_SOLUTIONS_ERROR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">arc_length</span><span class="p">);</span>
    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">arrange_parameters</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/arc_length.xml"</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/geodesic_problem/arc_length.xml"</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/arc_length.xml"</span><span class="p">);</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/geodesic_problem/arc_length_data.dat"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/neural_network.xml"</span><span class="p">);</span>
    <span class="n">performance_functional</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/performance_functional.xml"</span><span class="p">);</span>
    <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/training_strategy.xml"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="images/tres.gif" /></p>

<p><a href="https://www.youtube.com/watch?v=2nF2PdjxTvs">Video</a></p>

<p>Problem parameters
<br>
Mathematical model object
<br>
<br>
<br>
<br>
Neural network object
<br>
<br>
Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
<br>
Scaling layer
<br>
<br>
<br>
<br>
Unscaling layer
<br>
<br>
Conditions layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Performance functional object</p>

<p>Objective term
<br>
<br>
<br>
<br>
<br>
<br>
Training strategy object</p>

<p>Save results to file</p>

<h2 id="brachistochrone-problem">Brachistochrone problem</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#include "../../source/opennn.h"
</span>
<span class="cp">#include "descent_time.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>

    <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xa</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">ya</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">xb</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">yb</span> <span class="o">=</span>  <span class="mf">0.0</span><span class="p">;</span>

    <span class="n">DescentTime</span> <span class="n">descent_time</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">small</span> <span class="o">=</span> <span class="mf">1.0e-3</span><span class="p">;</span>

    <span class="n">descent_time</span><span class="p">.</span><span class="n">set_initial_independent_variable</span><span class="p">(</span><span class="n">xa</span><span class="o">+</span><span class="n">small</span><span class="p">);</span>
    <span class="n">descent_time</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">initialize_parameters_normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>
    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"x"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"y"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_conditions_layer</span><span class="p">();</span>
    <span class="n">ConditionsLayer</span><span class="o">*</span> <span class="n">conditions_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_conditions_layer_pointer</span><span class="p">();</span>

    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">external_input_values</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">external_input_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xa</span><span class="p">;</span>
    <span class="n">external_input_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xb</span><span class="p">;</span>

    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_values</span><span class="p">(</span><span class="n">external_input_values</span><span class="p">);</span>

    <span class="n">Matrix</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">output_values</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">output_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ya</span><span class="p">;</span>
    <span class="n">output_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">yb</span><span class="p">;</span>

    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_values</span><span class="p">(</span><span class="n">output_values</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_bounding_layer</span><span class="p">();</span>

    <span class="n">BoundingLayer</span><span class="o">*</span> <span class="n">bounding_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_bounding_layer_pointer</span><span class="p">();</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_upper_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">-</span><span class="mf">1.0e-3</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">construct_objective_term</span><span class="p">(</span><span class="n">PerformanceFunctional</span><span class="o">::</span><span class="n">FINAL_SOLUTIONS_ERROR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">descent_time</span><span class="p">);</span>

    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">arrange_parameters</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/brachistochrone_problem/neural_network.xml"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/brachistochrone_problem/expression.txt"</span><span class="p">);</span>

    <span class="n">descent_time</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/brachistochrone_problem/descent_time.dat"</span><span class="p">);</span>

    <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/brachistochrone_problem/training_strategy_results.dat"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="images/uno.gif" /></p>

<p><a href="https://www.youtube.com/watch?v=HlwuO0UZGP8">Video</a></p>

<p>Problem parameters
<br>
<br>
<br>
Mathematical model
<br>
<br>
<br>
<br>
Neural network
<br>
<br>
<br>
Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
Conditions layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Bounding layer
<br>
<br>
<br>
Performance functional</p>

<p>Objective term
<br>
<br>
<br>
<br>
<br>
<br>
Training strategy object
<br>
<br>
<br>
<br>
Save results</p>

<h2 id="catenary-problem">Catenary problem</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#include "../../source/opennn.h"
</span>
<span class="cp">#include "potential_energy.h"
#include "../geodesic_problem/arc_length.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">srand</span><span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span> <span class="nb">NULL</span> <span class="p">)</span> <span class="p">);</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xa</span> <span class="o">=</span>  <span class="mf">0.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">ya</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xb</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">yb</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">length</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span>

    <span class="n">PotentialEnergy</span> <span class="n">potential_energy</span><span class="p">;</span>

    <span class="n">potential_energy</span><span class="p">.</span><span class="n">set_initial_independent_variable</span><span class="p">(</span><span class="n">xa</span><span class="p">);</span>
    <span class="n">potential_energy</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>

    <span class="n">ArcLength</span> <span class="n">arc_length</span><span class="p">;</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">set_initial_independent_variable</span><span class="p">(</span><span class="n">xa</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>

    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>

    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"x"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"y"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_scaling_layer</span><span class="p">();</span>

    <span class="n">ScalingLayer</span><span class="o">*</span> <span class="n">scaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_scaling_layer_pointer</span><span class="p">();</span>

    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xa</span><span class="p">);</span>
    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xb</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_unscaling_layer</span><span class="p">();</span>

    <span class="n">UnscalingLayer</span><span class="o">*</span> <span class="n">unscaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_unscaling_layer_pointer</span><span class="p">();</span>

    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">yb</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_unscaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_conditions_layer</span><span class="p">();</span>

    <span class="n">ConditionsLayer</span><span class="o">*</span> <span class="n">conditions_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_conditions_layer_pointer</span><span class="p">();</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xa</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xb</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ya</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">yb</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_conditions_layer_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_bounding_layer</span><span class="p">();</span>

    <span class="n">BoundingLayer</span><span class="o">*</span> <span class="n">bounding_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_bounding_layer_pointer</span><span class="p">();</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_lower_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_upper_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">FinalSolutionsError</span><span class="o">*</span> <span class="n">final_solutions_error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FinalSolutionsError</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">potential_energy</span><span class="p">);</span>
    <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
    <span class="n">performance_functional</span><span class="p">.</span><span class="n">set_objective_term_pointer</span><span class="p">(</span><span class="n">final_solutions_error</span><span class="p">);</span>

    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">arrange_parameters</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">FinalSolutionsError</span><span class="o">*</span> <span class="n">constraints_term_pointer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FinalSolutionsError</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">arc_length</span><span class="p">);</span>

    <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">set_target_final_solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">set_constraints_term_pointer</span><span class="p">(</span><span class="n">constraints_term_pointer</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>

    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>

    <span class="n">potential_energy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/potential_energy.xml"</span><span class="p">);</span>
    <span class="n">potential_energy</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/potential_energy.xml"</span><span class="p">);</span>

    <span class="n">potential_energy</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/catenary_problem/potential_energy_data.dat"</span><span class="p">);</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/arc_length.xml"</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/arc_length.xml"</span><span class="p">);</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/catenary_problem/arc_length_data.dat"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/neural_network.xml"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/neural_network.xml"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="s">"../data/catenary_problem/neural_network_data.dat"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/catenary_problem/expression.txt"</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/performance_functional.xml"</span><span class="p">);</span>
    <span class="n">performance_functional</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/performance_functional.xml"</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/training_strategy.xml"</span><span class="p">);</span>
    <span class="n">training_strategy</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/training_strategy.xml"</span><span class="p">);</span>
    <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/training_strategy_results.xml"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="images/dos.gif" /></p>

<p><a href="https://www.youtube.com/watch?v=g2yenxp7zPQ">Video</a></p>

<p>Problem parameters
<br>
<br>
<br>
<br>
<br>
Mathematical models
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Neural network</p>

<p>Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
<br>
Scaling layer
<br>
<br>
<br>
<br>
<br>
<br>
Unscaling layer
<br>
<br>
<br>
<br>
<br>
<br>
Conditions layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Bounding layer
<br>
<br>
<br>
<br>
Performance functional</p>

<p>Objective term
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Constratints term
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Training strategy
<br>
<br>
<br>
<br>
Save results</p>

          <h1 id="optimal-control-problems">Optimal control problems</h1>

<h2 id="car-problem">Car problem</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#include "../../source/opennn.h"
</span>
<span class="cp">#include "car.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>

    <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">maximum_acceleration</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">maximum_deceleration</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">final_position</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">final_velocity</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>

    <span class="n">Car</span> <span class="n">car</span><span class="p">;</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">initialize_parameters_normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>

    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>

    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"time"</span><span class="p">);</span>

    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"throttle_acceleration"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"bracking_deceleration"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_scaling_layer</span><span class="p">();</span>

    <span class="n">ScalingLayer</span><span class="o">*</span> <span class="n">scaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_scaling_layer_pointer</span><span class="p">();</span>

    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_unscaling_layer</span><span class="p">();</span>

    <span class="n">UnscalingLayer</span><span class="o">*</span> <span class="n">unscaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_unscaling_layer_pointer</span><span class="p">();</span>

    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maximum_acceleration</span><span class="p">);</span>

    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">maximum_deceleration</span><span class="p">);</span>
    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_unscaling_layer_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_bounding_layer</span><span class="p">();</span>

    <span class="n">BoundingLayer</span><span class="o">*</span> <span class="n">bounding_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_bounding_layer_pointer</span><span class="p">();</span>

    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_lower_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_upper_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maximum_acceleration</span><span class="p">);</span>

    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_lower_bound</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">maximum_deceleration</span><span class="p">);</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_upper_bound</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_independent_parameters</span><span class="p">();</span>

    <span class="n">IndependentParameters</span><span class="o">*</span> <span class="n">independent_parameters_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_independent_parameters_pointer</span><span class="p">();</span>

    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_parameters_number</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_parameter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.1415927</span><span class="p">);</span>

    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"final_time"</span><span class="p">);</span>

    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_lower_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>

    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_bounding_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">car</span><span class="p">);</span>

    <span class="n">IndependentParametersError</span><span class="o">*</span> <span class="n">independent_parameters_error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IndependentParametersError</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">independent_parameters_error</span><span class="o">-&gt;</span><span class="n">set_independent_parameter_error_weight</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0e-3</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">set_objective_term_pointer</span><span class="p">(</span><span class="n">independent_parameters_error</span><span class="p">);</span>

    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">arrange_parameters</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">independent_parameters_error</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">independent_parameters_error</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">independent_parameters_error</span><span class="o">-&gt;</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">FinalSolutionsError</span><span class="o">*</span> <span class="n">final_solutions_error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FinalSolutionsError</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">car</span><span class="p">);</span>

    <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">set_target_final_solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">final_position</span><span class="p">);</span>
    <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">set_target_final_solution</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">final_velocity</span><span class="p">);</span>

    <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
    <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">set_constraints_term_pointer</span><span class="p">(</span><span class="n">final_solutions_error</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
    <span class="n">training_strategy</span><span class="p">.</span><span class="n">construct_initialization_training_algorithm</span><span class="p">(</span><span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">EVOLUTIONARY_ALGORITHM</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">construct_main_training_algorithm</span><span class="p">(</span><span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">GRADIENT_DESCENT</span><span class="p">);</span>

    <span class="k">const</span> <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">final_time</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_independent_parameters_pointer</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">get_parameter</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="n">car</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">final_time</span><span class="p">);</span>

    <span class="n">car</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/car_problem/car.xml"</span><span class="p">);</span>
    <span class="n">car</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/car_problem/car_data.dat"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/car_problem/neural_network.xml"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/car_problem/expression.txt"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="s">"../data/car_problem/neural_network_data.dat"</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/car_problem/performance_functional.xml"</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/car_problem/training_strategy.xml"</span><span class="p">);</span>
    <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/car_problem/training_strategy_results.dat"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="images/CarProblem.gif" /></p>

<p><br>
<br>
Problem parameters
<br>
<br>
<br>
<br>
Mathematical model</p>

<p>Neural network
<br>
<br>
Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Scaling layer
<br>
<br>
<br>
<br>
<br>
Unscaling layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Bounding layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Independent parameters
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Performance functional</p>

<p>Objective term
<br>
<br>
<br>
<br>
Constraints term
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Training strategy
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Save results</p>

<h2 id="maximal-feed-rate-to-a-fed-batch-fermenter">Maximal feed rate to a fed batch fermenter</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
#include "../../source/opennn.h"
#include "fed_batch_fermenter.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

    <span class="kt">double</span> <span class="n">fermenter_volume</span> <span class="o">=</span> <span class="mf">200.0</span><span class="p">;</span>

    <span class="kt">double</span> <span class="n">maximum_feed_rate</span> <span class="o">=</span> <span class="mf">12.0</span><span class="p">;</span>

    <span class="kt">double</span> <span class="n">final_time</span> <span class="o">=</span> <span class="mf">54.0</span><span class="p">;</span>

    <span class="n">FedBatchFermenter</span> <span class="n">fed_batch_fermenter</span><span class="p">;</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>

    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>

    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"time"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"feed_rate"</span><span class="p">);</span>

    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_units</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"seconds"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_units</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"grams"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_scaling_layer</span><span class="p">();</span>

    <span class="n">ScalingLayer</span><span class="o">*</span> <span class="n">scaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_scaling_layer_pointer</span><span class="p">();</span>

    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">final_time</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_unscaling_layer</span><span class="p">();</span>

    <span class="n">UnscalingLayer</span><span class="o">*</span> <span class="n">unscaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_unscaling_layer_pointer</span><span class="p">();</span>

    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maximum_feed_rate</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_bounding_layer</span><span class="p">();</span>

    <span class="n">BoundingLayer</span><span class="o">*</span> <span class="n">bounding_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_bounding_layer_pointer</span><span class="p">();</span>

    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_lower_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_upper_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maximum_feed_rate</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">initialize_parameters_normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0e-3</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">FinalSolutionsError</span><span class="o">*</span> <span class="n">objective_term_pointer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FinalSolutionsError</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">fed_batch_fermenter</span><span class="p">);</span>

    <span class="n">objective_term_pointer</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">objective_term_pointer</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">objective_term_pointer</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0e-9</span><span class="p">);</span>
    <span class="n">objective_term_pointer</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">set_objective_term_pointer</span><span class="p">(</span><span class="n">objective_term_pointer</span><span class="p">);</span>

    <span class="n">FinalSolutionsError</span><span class="o">*</span> <span class="n">constraints_term_pointer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FinalSolutionsError</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">fed_batch_fermenter</span><span class="p">);</span>

    <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">set_target_final_solution</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">fermenter_volume</span><span class="p">);</span>

    <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.0e-6</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">set_constraints_term_pointer</span><span class="p">(</span><span class="n">constraints_term_pointer</span><span class="p">);</span>

    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">arrange_parameters</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">construct_initialization_training_algorithm</span><span class="p">(</span><span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">EVOLUTIONARY_ALGORITHM</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">construct_main_training_algorithm</span><span class="p">(</span><span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">QUASI_NEWTON_METHOD</span><span class="p">);</span>

    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>

    <span class="n">fed_batch_fermenter</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/fed_batch_fermenter/fed_batch_fermenter.xml"</span><span class="p">);</span>
    <span class="n">fed_batch_fermenter</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/fed_batch_fermenter_data.dat"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/fed_batch_fermenter/neural_network.xml"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/fed_batch_fermenter/expression.txt"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="s">"../data/fed_batch_fermenter/neural_network_data.dat"</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/fed_batch_fermenter/performance_functional.xml"</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/fed_batch_fermenter/training_strategy.xml"</span><span class="p">);</span>
    <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/fed_batch_fermenter/training_strategy_results.dat"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="images/FedBatchFermenter.gif" /></p>

<p>Problem parameters</p>

<p>Mathematical model</p>

<p>Neural network
<br>
<br>
<br>
Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Scaling layer
<br>
<br>
<br>
<br>
<br>
Unscaling layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Bounding layer
<br>
<br>
<br>
<br>
Performance functional</p>

<p>Objective term
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Constraints term
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Training strategy</p>

<p>Initialization training algorithm</p>

<p>Main training algorithm
<br>
<br>
<br>
Save results</p>

          <h1 id="inverse-problems">Inverse problems</h1>

<h2 id="precipitate-dissolution-model-of-an-aluminium-alloy">Precipitate dissolution model of an aluminium alloy</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#include "../../source/opennn.h"
</span>
<span class="cp">#include "precipitate_dissolution.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">PrecipitateDissolution</span> <span class="n">precipitate_dissolution</span><span class="p">;</span>

    <span class="n">precipitate_dissolution</span><span class="p">.</span><span class="n">set_reference_temperature</span><span class="p">(</span><span class="mf">573.16</span><span class="p">);</span> <span class="c1">// K
</span>    <span class="n">precipitate_dissolution</span><span class="p">.</span><span class="n">set_reference_time</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="c1">// s
</span>
    <span class="n">precipitate_dissolution</span><span class="p">.</span><span class="n">set_minimum_Vickers_hardness</span><span class="p">(</span><span class="mf">66.9124</span><span class="p">);</span>
    <span class="n">precipitate_dissolution</span><span class="p">.</span><span class="n">set_maximum_Vickers_hardness</span><span class="p">(</span><span class="mf">151.9350</span><span class="p">);</span>

    <span class="n">DataSet</span> <span class="n">data_set</span><span class="p">;</span>

    <span class="n">data_set</span><span class="p">.</span><span class="n">load_data</span><span class="p">(</span><span class="s">"../data/precipitate_dissolution/DataAA-2014-T6.dat"</span><span class="p">);</span>

    <span class="n">VariablesInformation</span><span class="o">*</span> <span class="n">variables_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information_pointer</span><span class="p">();</span>

    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"temperature"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"time"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"vickers_hardness"</span><span class="p">);</span>

    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"celsius"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"s"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"none"</span><span class="p">);</span>

    <span class="k">const</span> <span class="n">Matrix</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">input_data</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">arrange_input_data</span><span class="p">();</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>

    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>

    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"log(t/t*)"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"1-f/f0"</span><span class="p">);</span>

    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_units</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"none"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_units</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"none"</span><span class="p">);</span>

    <span class="n">MultilayerPerceptron</span><span class="o">*</span> <span class="n">multilayer_perceptron_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_multilayer_perceptron_pointer</span><span class="p">();</span>

    <span class="n">multilayer_perceptron_pointer</span><span class="o">-&gt;</span><span class="n">initialize_parameters_normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0e-2</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_scaling_layer</span><span class="p">();</span>

    <span class="n">ScalingLayer</span><span class="o">*</span> <span class="n">scaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_scaling_layer_pointer</span><span class="p">();</span>

    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">);</span>
    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_unscaling_layer</span><span class="p">();</span>

    <span class="n">UnscalingLayer</span><span class="o">*</span> <span class="n">unscaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_unscaling_layer_pointer</span><span class="p">();</span>

    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_bounding_layer</span><span class="p">();</span>

    <span class="n">BoundingLayer</span><span class="o">*</span> <span class="n">bounding_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_bounding_layer_pointer</span><span class="p">();</span>

    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_lower_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_upper_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_independent_parameters</span><span class="p">();</span>

    <span class="n">IndependentParameters</span><span class="o">*</span> <span class="n">independent_parameters_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_independent_parameters_pointer</span><span class="p">();</span>

    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_parameters_number</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"effective_activation_energy"</span><span class="p">);</span>

    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">);</span>
    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">200.0</span><span class="p">);</span>

    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_lower_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>

    <span class="n">independent_parameters_pointer</span><span class="o">-&gt;</span><span class="n">set_parameter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">);</span>

    <span class="n">precipitate_dissolution</span><span class="p">.</span><span class="n">calculate_dependent_variables</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="n">input_data</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">construct_objective_term</span><span class="p">(</span><span class="n">PerformanceFunctional</span><span class="o">::</span><span class="n">INVERSE_SUM_SQUARED_ERROR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">precipitate_dissolution</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/AA-7449-T79/NeuralNetworkAA-7449-T79.dat"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="images/PrecipitateDissolutionModel.gif" /></p>

<p><a href="data/DataAA-2014-T6.dat">Download data set</a></p>

<p>Mathematical model
<br>
<br>
<br>
Data set
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Neural network
<br>
<br>
<br>
Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Multilayer perceptron
<br>
<br>
<br>
Scaling layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Unscaling layer
<br>
<br>
<br>
<br>
<br>
Bounding layer
<br>
<br>
<br>
<br>
<br>
Independent parameters
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Performance functional</p>

<p>Objective term
<br>
<br>
<br>
Training strategy</p>

<p>Save results</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
