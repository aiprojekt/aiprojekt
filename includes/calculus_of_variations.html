<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>OpenNN examples</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_calculus_of_variations">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <div style="background-color: white">
        <center>
        <img src="../images/logo.png" />
        </center>
      </div>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="classical-problems-in-the-calculus-of-variations">Classical problems in the calculus of variations</h1>

<h2 id="geodesic-problem">Geodesic problem</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
#include "arc_length.h"
#include "../../source/opennn.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xa</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">ya</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xb</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">yb</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>

    <span class="n">ArcLength</span> <span class="n">arc_length</span><span class="p">;</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">set_initial_independent_variable</span><span class="p">(</span><span class="n">xa</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>

    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"x"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"y"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_scaling_layer</span><span class="p">();</span>

    <span class="n">ScalingLayer</span><span class="o">*</span> <span class="n">scaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_scaling_layer_pointer</span><span class="p">();</span>
    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xa</span><span class="p">);</span>
    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xb</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_unscaling_layer</span><span class="p">();</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_unscaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_conditions_layer</span><span class="p">();</span>
    <span class="n">ConditionsLayer</span><span class="o">*</span> <span class="n">conditions_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_conditions_layer_pointer</span><span class="p">();</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xa</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xb</span><span class="p">);</span>

    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ya</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">yb</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_conditions_layer_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">construct_objective_term</span><span class="p">(</span><span class="n">PerformanceFunctional</span><span class="o">::</span><span class="n">FINAL_SOLUTIONS_ERROR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">arc_length</span><span class="p">);</span>
    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">arrange_parameters</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/arc_length.xml"</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/geodesic_problem/arc_length.xml"</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/arc_length.xml"</span><span class="p">);</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/geodesic_problem/arc_length_data.dat"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/neural_network.xml"</span><span class="p">);</span>
    <span class="n">performance_functional</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/performance_functional.xml"</span><span class="p">);</span>
    <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/geodesic_problem/training_strategy.xml"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="../images/tres.gif" /></p>

<p><a href="https://www.youtube.com/watch?v=2nF2PdjxTvs">Video</a></p>

<p>Problem parameters
<br>
Mathematical model object
<br>
<br>
<br>
<br>
Neural network object
<br>
<br>
Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
<br>
Scaling layer
<br>
<br>
<br>
<br>
Unscaling layer
<br>
<br>
Conditions layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Performance functional object</p>

<p>Objective term
<br>
<br>
<br>
<br>
<br>
<br>
Training strategy object</p>

<p>Save results to file</p>

<h2 id="brachistochrone-problem">Brachistochrone problem</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#include "../../source/opennn.h"
</span>
<span class="cp">#include "descent_time.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>

    <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xa</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">ya</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">xb</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">yb</span> <span class="o">=</span>  <span class="mf">0.0</span><span class="p">;</span>

    <span class="n">DescentTime</span> <span class="n">descent_time</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">small</span> <span class="o">=</span> <span class="mf">1.0e-3</span><span class="p">;</span>

    <span class="n">descent_time</span><span class="p">.</span><span class="n">set_initial_independent_variable</span><span class="p">(</span><span class="n">xa</span><span class="o">+</span><span class="n">small</span><span class="p">);</span>
    <span class="n">descent_time</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">initialize_parameters_normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>
    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"x"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"y"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_conditions_layer</span><span class="p">();</span>
    <span class="n">ConditionsLayer</span><span class="o">*</span> <span class="n">conditions_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_conditions_layer_pointer</span><span class="p">();</span>

    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">external_input_values</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">external_input_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xa</span><span class="p">;</span>
    <span class="n">external_input_values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xb</span><span class="p">;</span>

    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_values</span><span class="p">(</span><span class="n">external_input_values</span><span class="p">);</span>

    <span class="n">Matrix</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">output_values</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">output_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ya</span><span class="p">;</span>
    <span class="n">output_values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">yb</span><span class="p">;</span>

    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_values</span><span class="p">(</span><span class="n">output_values</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_bounding_layer</span><span class="p">();</span>

    <span class="n">BoundingLayer</span><span class="o">*</span> <span class="n">bounding_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_bounding_layer_pointer</span><span class="p">();</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_upper_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">-</span><span class="mf">1.0e-3</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">construct_objective_term</span><span class="p">(</span><span class="n">PerformanceFunctional</span><span class="o">::</span><span class="n">FINAL_SOLUTIONS_ERROR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">descent_time</span><span class="p">);</span>

    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">arrange_parameters</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/brachistochrone_problem/neural_network.xml"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/brachistochrone_problem/expression.txt"</span><span class="p">);</span>

    <span class="n">descent_time</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/brachistochrone_problem/descent_time.dat"</span><span class="p">);</span>

    <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/brachistochrone_problem/training_strategy_results.dat"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="../images/uno.gif" /></p>

<p><a href="https://www.youtube.com/watch?v=HlwuO0UZGP8">Video</a></p>

<p>Problem parameters
<br>
<br>
<br>
Mathematical model
<br>
<br>
<br>
<br>
Neural network
<br>
<br>
<br>
Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
Conditions layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Bounding layer
<br>
<br>
<br>
Performance functional</p>

<p>Objective term
<br>
<br>
<br>
<br>
<br>
<br>
Training strategy object
<br>
<br>
<br>
<br>
Save results</p>

<h2 id="catenary-problem">Catenary problem</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#include "../../source/opennn.h"
</span>
<span class="cp">#include "potential_energy.h"
#include "../geodesic_problem/arc_length.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">srand</span><span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span> <span class="nb">NULL</span> <span class="p">)</span> <span class="p">);</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xa</span> <span class="o">=</span>  <span class="mf">0.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">ya</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">xb</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">yb</span> <span class="o">=</span>  <span class="mf">1.0</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">double</span> <span class="n">length</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">;</span>

    <span class="n">PotentialEnergy</span> <span class="n">potential_energy</span><span class="p">;</span>

    <span class="n">potential_energy</span><span class="p">.</span><span class="n">set_initial_independent_variable</span><span class="p">(</span><span class="n">xa</span><span class="p">);</span>
    <span class="n">potential_energy</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>

    <span class="n">ArcLength</span> <span class="n">arc_length</span><span class="p">;</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">set_initial_independent_variable</span><span class="p">(</span><span class="n">xa</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">set_final_independent_variable</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>

    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_inputs_outputs_information</span><span class="p">();</span>

    <span class="n">InputsOutputsInformation</span><span class="o">*</span> <span class="n">inputs_outputs_information_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_inputs_outputs_information_pointer</span><span class="p">();</span>

    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_input_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"x"</span><span class="p">);</span>
    <span class="n">inputs_outputs_information_pointer</span><span class="o">-&gt;</span><span class="n">set_output_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"y"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_scaling_layer</span><span class="p">();</span>

    <span class="n">ScalingLayer</span><span class="o">*</span> <span class="n">scaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_scaling_layer_pointer</span><span class="p">();</span>

    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xa</span><span class="p">);</span>
    <span class="n">scaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xb</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_unscaling_layer</span><span class="p">();</span>

    <span class="n">UnscalingLayer</span><span class="o">*</span> <span class="n">unscaling_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_unscaling_layer_pointer</span><span class="p">();</span>

    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">unscaling_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_maximum</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">yb</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_unscaling_layer_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_conditions_layer</span><span class="p">();</span>

    <span class="n">ConditionsLayer</span><span class="o">*</span> <span class="n">conditions_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_conditions_layer_pointer</span><span class="p">();</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">xa</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_external_input_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">xb</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ya</span><span class="p">);</span>
    <span class="n">conditions_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_output_value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">yb</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_conditions_layer_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">construct_bounding_layer</span><span class="p">();</span>

    <span class="n">BoundingLayer</span><span class="o">*</span> <span class="n">bounding_layer_pointer</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">get_bounding_layer_pointer</span><span class="p">();</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_lower_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>
    <span class="n">bounding_layer_pointer</span><span class="o">-&gt;</span><span class="n">set_upper_bound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">);</span>

    <span class="n">FinalSolutionsError</span><span class="o">*</span> <span class="n">final_solutions_error</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FinalSolutionsError</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">potential_energy</span><span class="p">);</span>
    <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">set_final_solution_error_weight</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">);</span>
    <span class="n">performance_functional</span><span class="p">.</span><span class="n">set_objective_term_pointer</span><span class="p">(</span><span class="n">final_solutions_error</span><span class="p">);</span>

    <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">neural_network</span><span class="p">.</span><span class="n">arrange_parameters</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">final_solutions_error</span><span class="o">-&gt;</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">FinalSolutionsError</span><span class="o">*</span> <span class="n">constraints_term_pointer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FinalSolutionsError</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">arc_length</span><span class="p">);</span>

    <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">set_target_final_solution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">set_constraints_term_pointer</span><span class="p">(</span><span class="n">constraints_term_pointer</span><span class="p">);</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">constraints_term_pointer</span><span class="o">-&gt;</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_evaluation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">performance_functional</span><span class="p">.</span><span class="n">calculate_gradient</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>

    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>

    <span class="n">potential_energy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/potential_energy.xml"</span><span class="p">);</span>
    <span class="n">potential_energy</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/potential_energy.xml"</span><span class="p">);</span>

    <span class="n">potential_energy</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/catenary_problem/potential_energy_data.dat"</span><span class="p">);</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/arc_length.xml"</span><span class="p">);</span>
    <span class="n">arc_length</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/arc_length.xml"</span><span class="p">);</span>

    <span class="n">arc_length</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="n">neural_network</span><span class="p">,</span> <span class="s">"../data/catenary_problem/arc_length_data.dat"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/neural_network.xml"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/neural_network.xml"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_data</span><span class="p">(</span><span class="s">"../data/catenary_problem/neural_network_data.dat"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/catenary_problem/expression.txt"</span><span class="p">);</span>

    <span class="n">performance_functional</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/performance_functional.xml"</span><span class="p">);</span>
    <span class="n">performance_functional</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/performance_functional.xml"</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/training_strategy.xml"</span><span class="p">);</span>
    <span class="n">training_strategy</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/catenary_problem/training_strategy.xml"</span><span class="p">);</span>
    <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/catenary_problem/training_strategy_results.xml"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="../images/dos.gif" /></p>

<p><a href="https://www.youtube.com/watch?v=g2yenxp7zPQ">Video</a></p>

<p>Problem parameters
<br>
<br>
<br>
<br>
<br>
Mathematical models
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Neural network</p>

<p>Inputs-outputs information
<br>
<br>
<br>
<br>
<br>
<br>
Scaling layer
<br>
<br>
<br>
<br>
<br>
<br>
Unscaling layer
<br>
<br>
<br>
<br>
<br>
<br>
Conditions layer
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Bounding layer
<br>
<br>
<br>
<br>
Performance functional</p>

<p>Objective term
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Constratints term
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Training strategy
<br>
<br>
<br>
<br>
Save results</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
