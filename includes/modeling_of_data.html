<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>OpenNN examples</title>

    <link href="../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="../javascripts/all_nosearch.js" type="text/javascript"></script>

  </head>

  <body class="includes includes_modeling_of_data">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <div style="background-color: white">
        <center>
        <img src="../images/logo.png" />
        </center>
      </div>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="modeling-of-data">Modeling of data</h1>

<h2 id="linear-regression-analysis-for-predicting-self-noise-of-airfoils">Linear regression analysis for predicting self noise of airfoils</h2>
<pre class="highlight cpp"><code>    <span class="cp">#include &lt;iostream&gt;
</span>    <span class="cp">#include &lt;fstream&gt;
</span>    <span class="cp">#include &lt;sstream&gt;
</span>    <span class="cp">#include &lt;string&gt;
</span>    <span class="cp">#include &lt;cstring&gt;
</span>    <span class="cp">#include &lt;time.h&gt;
</span>
    <span class="cp">#include "../../source/opennn.h"
</span>
    <span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

    <span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

        <span class="n">DataSet</span> <span class="n">data_set</span><span class="p">;</span>
        <span class="n">data_set</span><span class="p">.</span><span class="n">load_data</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/airfoil_self_noise.dat"</span><span class="p">);</span>

        <span class="n">VariablesInformation</span><span class="o">*</span> <span class="n">variables_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information_pointer</span><span class="p">();</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"frequency"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"hertzs"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"angle_of_attack"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"degrees"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"chord_length"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"meters"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">"free_stream_velocity"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">"meters per second"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">"suction_side_displacement_thickness"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">"meters"</span><span class="p">);</span>

        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s">"scaled_sound_pressure_level"</span><span class="p">);</span>
        <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_units</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s">"decibels"</span><span class="p">);</span>

        <span class="k">const</span> <span class="n">Vector</span><span class="o">&lt;</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">inputs_targets_information</span> <span class="o">=</span> <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">arrange_inputs_targets_information</span><span class="p">();</span>

        <span class="k">const</span> <span class="n">Vector</span><span class="o">&lt;</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">inputs_targets_statistics</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">scale_inputs_targets</span><span class="p">();</span>

        <span class="n">InstancesInformation</span><span class="o">*</span> <span class="n">instances_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_instances_information_pointer</span><span class="p">();</span>

        <span class="n">instances_information_pointer</span><span class="o">-&gt;</span><span class="n">split_random_indices</span><span class="p">();</span>

        <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">inputs_number</span> <span class="o">=</span> <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">count_inputs_number</span><span class="p">();</span>
        <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hidden_perceptrons_number</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
        <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">outputs_number</span> <span class="o">=</span> <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">count_targets_number</span><span class="p">();</span>
        <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="n">inputs_number</span><span class="p">,</span> <span class="n">hidden_perceptrons_number</span><span class="p">,</span> <span class="n">outputs_number</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_outputs_information</span><span class="p">(</span><span class="n">inputs_targets_information</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_outputs_statistics</span><span class="p">(</span><span class="n">inputs_targets_statistics</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_unscaling_layers_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

        <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>

        <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
        <span class="n">QuasiNewtonMethod</span><span class="o">*</span> <span class="n">quasi_Newton_method_pointer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QuasiNewtonMethod</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
        <span class="n">quasi_Newton_method_pointer</span><span class="o">-&gt;</span><span class="n">set_minimum_performance_increase</span><span class="p">(</span><span class="mf">1.0e-6</span><span class="p">);</span>
        <span class="n">quasi_Newton_method_pointer</span><span class="o">-&gt;</span><span class="n">set_reserve_evaluation_history</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="n">training_strategy</span><span class="p">.</span><span class="n">set_main_training_algorithm_pointer</span><span class="p">(</span><span class="n">quasi_Newton_method_pointer</span><span class="p">);</span>
        <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_scaling_outputs_unscaling_methods</span><span class="p">(</span><span class="s">"MinimumMaximum"</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_unscaling_layers_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

        <span class="n">TestingAnalysis</span> <span class="n">testing_analysis</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>
        <span class="n">FunctionRegressionTesting</span><span class="o">*</span> <span class="n">function_regression_testing_pointer</span> <span class="o">=</span> <span class="n">testing_analysis</span><span class="p">.</span><span class="n">get_function_regression_testing_pointer</span><span class="p">();</span>
        <span class="n">FunctionRegressionTesting</span><span class="o">::</span><span class="n">LinearRegressionAnalysisResults</span> <span class="n">linear_regression_analysis_results</span> <span class="o">=</span> <span class="n">function_regression_testing_pointer</span><span class="o">-&gt;</span><span class="n">perform_linear_regression_analysis</span><span class="p">();</span>

        <span class="n">data_set</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/data_set.xml"</span><span class="p">);</span>
        <span class="n">data_set</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/data_set.xml"</span><span class="p">);</span>

        <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/neural_network.xml"</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/neural_network.xml"</span><span class="p">);</span>
        <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/expression.txt"</span><span class="p">);</span>

        <span class="n">performance_functional</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/performance_functional.xml"</span><span class="p">);</span>
        <span class="n">performance_functional</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/performance_functional.xml"</span><span class="p">);</span>

        <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/training_strategy.xml"</span><span class="p">);</span>
        <span class="n">training_strategy</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/training_strategy.xml"</span><span class="p">);</span>

        <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/training_strategy_results.dat"</span><span class="p">);</span>

        <span class="n">linear_regression_analysis_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/airfoil_self_noise/linear_regression_analysis_results.dat"</span><span class="p">);</span>

        <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="p">}</span>
</code></pre>

<p><img alt="Alt text" src="../images/AirfoilSelfNoise.gif" /></p>

<p><a href="data/airfoil_self_noise_data.dat">Download data set</a>
<br>
<br>
<br>
<br>
Loading the data set
<br>
<br>
<br>
Variables information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Instances information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Neural network
<br>
<br>
<br>
Performance functional
<br>
Training strategy object
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Testing analysis
<br>
<br>
<br>
<br>
<br>
<br>
Save results</p>

<h2 id="linear-regression-analysis-for-predicting-residuary-resistance-of-yachts">Linear regression analysis for predicting residuary resistance of yachts</h2>
<pre class="highlight cpp"><code><span class="cp">#include &lt;iostream&gt;
#include &lt;fstream&gt;
#include &lt;sstream&gt;
#include &lt;string&gt;
#include &lt;cstring&gt;
#include &lt;time.h&gt;
</span>
<span class="cp">#include "../../source/opennn.h"
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">OpenNN</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>

    <span class="n">DataSet</span> <span class="n">data_set</span><span class="p">;</span>
    <span class="n">data_set</span><span class="p">.</span><span class="n">load_data</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/delft.dat"</span><span class="p">);</span>

    <span class="n">VariablesInformation</span><span class="o">*</span> <span class="n">variables_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information_pointer</span><span class="p">();</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">"longitudinal_center_buoyancy"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">"prismatic_coecient"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">"length_displacement_ratio"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s">"beam_draught_ratio"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s">"length_beam_ratio"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s">"froude_number"</span><span class="p">);</span>
    <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s">"residuary_resistance"</span><span class="p">);</span>
    <span class="k">const</span> <span class="n">Vector</span><span class="o">&lt;</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">inputs_targets_information</span> <span class="o">=</span> <span class="n">variables_information_pointer</span><span class="o">-&gt;</span><span class="n">arrange_inputs_targets_information</span><span class="p">();</span>

    <span class="n">InstancesInformation</span><span class="o">*</span> <span class="n">instances_information_pointer</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_instances_information_pointer</span><span class="p">();</span>
    <span class="n">instances_information_pointer</span><span class="o">-&gt;</span><span class="n">split_random_indices</span><span class="p">();</span>
    <span class="k">const</span> <span class="n">Vector</span><span class="o">&lt;</span> <span class="n">Vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">inputs_targets_statistics</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">scale_inputs_targets</span><span class="p">();</span>

    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">inputs_number</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information</span><span class="p">().</span><span class="n">count_inputs_number</span><span class="p">();</span>
    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hidden_neurons_number</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">outputs_number</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">.</span><span class="n">get_variables_information</span><span class="p">().</span><span class="n">count_targets_number</span><span class="p">();</span>
    <span class="n">NeuralNetwork</span> <span class="n">neural_network</span><span class="p">(</span><span class="n">inputs_number</span><span class="p">,</span> <span class="n">hidden_neurons_number</span><span class="p">,</span> <span class="n">outputs_number</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_outputs_information</span><span class="p">(</span><span class="n">inputs_targets_information</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_inputs_outputs_statistics</span><span class="p">(</span><span class="n">inputs_targets_statistics</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_unscaling_layers_flag</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>

    <span class="n">PerformanceFunctional</span> <span class="n">performance_functional</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>

    <span class="n">TrainingStrategy</span> <span class="n">training_strategy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">performance_functional</span><span class="p">);</span>
    <span class="n">TrainingStrategy</span><span class="o">::</span><span class="n">Results</span> <span class="n">training_strategy_results</span> <span class="o">=</span> <span class="n">training_strategy</span><span class="p">.</span><span class="n">perform_training</span><span class="p">();</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">set_scaling_unscaling_layers_flag</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

    <span class="n">TestingAnalysis</span> <span class="n">testing_analysis</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neural_network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data_set</span><span class="p">);</span>
    <span class="n">FunctionRegressionTesting</span><span class="o">*</span> <span class="n">function_regression_testing_pointer</span> <span class="o">=</span> <span class="n">testing_analysis</span><span class="p">.</span><span class="n">get_function_regression_testing_pointer</span><span class="p">();</span>
    <span class="n">FunctionRegressionTesting</span><span class="o">::</span><span class="n">LinearRegressionAnalysisResults</span> <span class="n">linear_regression_analysis_results</span> <span class="o">=</span> <span class="n">function_regression_testing_pointer</span><span class="o">-&gt;</span><span class="n">perform_linear_regression_analysis</span><span class="p">();</span>

    <span class="n">data_set</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/neural_network.xml"</span><span class="p">);</span>

    <span class="n">neural_network</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/neural_network.xml"</span><span class="p">);</span>
    <span class="n">neural_network</span><span class="p">.</span><span class="n">save_expression</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/expression.txt"</span><span class="p">);</span>

    <span class="n">training_strategy</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/training_strategy.xml"</span><span class="p">);</span>
    <span class="n">training_strategy_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/training_strategy_results.dat"</span><span class="p">);</span>

    <span class="n">linear_regression_analysis_results</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"../data/yacht_resistance_design/linear_regression_analysis_results.dat"</span><span class="p">);</span>

    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</code></pre>

<p><img alt="Alt text" src="../images/YachtResistanceProblem.gif" /></p>

<p><a href="data/yacht_resistance.dat">Download data set</a>
<br>
<br>
Loading the data set
<br>
<br>
<br>
Variables information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Instances information
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Neural network
<br>
<br>
<br>
Performance functional
<br>
<br>
Training strategy object
<br>
<br>
<br>
Testing analysis
<br>
<br>
<br>
<br>
Save results</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
